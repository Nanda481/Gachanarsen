<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gacha Simple - Gacha Mod</title>
<style>
  :root{
    --bg:#080612; --card:rgba(14,6,24,0.7); --accent:#a855f7; --neon: #b794f4;
    --muted: #9aa4b2;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto; background:var(--bg); color:#eef2ff; -webkit-font-smoothing:antialiased;}
  .wrap{min-height:100vh;display:flex;flex-direction:column;}
  header{display:flex;justify-content:space-between;align-items:center;padding:18px 28px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
  .brand{display:flex;gap:12px;align-items:center}
  #logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;font-weight:700}
  h1{margin:0;font-size:18px}
  .actions{display:flex;gap:10px;align-items:center}
  a.btn, button.btn{padding:10px 16px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  a.btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;text-decoration:none}
  button.primary{background:linear-gradient(90deg,var(--accent),#6d28d9);color:white}
  button.disabled{opacity:.45;pointer-events:none}
  main{flex:1;padding:28px;display:flex;flex-direction:column;gap:18px}
  .control-row{display:flex;gap:12px;align-items:center}
  .arena{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:14px;box-shadow:0 8px 30px rgba(0,0,0,0.5)}
  .viewport{width:100%;max-width:900px;height:160px;margin:18px auto;overflow:hidden;border-radius:12px;background:linear-gradient(90deg, rgba(10,6,20,0.7), rgba(15,8,30,0.55));position:relative;border:1px solid rgba(168,85,247,0.08)}
  .track{display:flex;gap:12px;position:absolute;left:0;top:0;height:100%;align-items:center;padding:0 40px;will-change:transform}
  .card{width:140px;height:120px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 6px 20px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}
  .card img{max-width:86%;max-height:66%;border-radius:8px}
  .card .name{font-size:13px;margin-top:8px;color:var(--neon);font-weight:700;text-align:center;padding:0 6px}
  .center-marker{position:absolute;left:50%;top:0;transform:translateX(-50%);height:100%;width:4px;pointer-events:none;background:linear-gradient(180deg, rgba(200,150,255,0.15), rgba(200,150,255,0.25));box-shadow:0 0 24px rgba(168,85,247,0.15)}
  .controls{display:flex;gap:12px;align-items:center;justify-content:center;margin-top:6px}
  #spin{padding:12px 22px;border-radius:999px;background:linear-gradient(90deg,var(--accent),#6d28d9);border:none;color:white;font-weight:800;cursor:pointer}
  #spin.disabled{opacity:.5;pointer-events:none}
  #result{margin-top:12px;text-align:center;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;gap:12px;align-items:center;justify-content:center}
  .glow{padding:8px 14px;border-radius:8px;background:linear-gradient(90deg, rgba(168,85,247,0.12), rgba(168,85,247,0.08));box-shadow:0 10px 40px rgba(168,85,247,0.12);border:1px solid rgba(168,85,247,0.14)}
  .muted{color:var(--muted);font-size:13px}
  input[type=file]{display:none}
  .small-btn{padding:8px 10px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);cursor:pointer}
  footer{padding:14px;text-align:center;color:var(--muted);font-size:13px}
  @media(max-width:720px){ .card{width:110px;height:100px} .viewport{height:140px} }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div id="logo">LOGO</div>
      <div>
        <h1>Gacha Mod</h1>
        <div class="muted">Subscribe → Gacha → Dapatkan mod rare</div>
      </div>
    </div>
    <div class="actions">
      <a id="subscribeBtn" class="btn" target="_blank">Subscribe</a>
      <button id="enterGacha" class="btn primary disabled" disabled>GACHA</button>
    </div>
  </header>

  <main>
    <div class="arena">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="control-row">
          <label class="small-btn">Logo <input id="logoInput" type="file" accept="image/*"></label>
          <label class="small-btn">Background <input id="bgInput" type="file" accept="image/*"></label>
          <div class="muted" style="margin-left:10px">Tema: Ungu Neon</div>
        </div>
        <div class="muted">Music autoplay enabled</div>
      </div>

      <div class="viewport" id="viewport">
        <div class="track" id="track">
          <!-- cards will be injected -->
        </div>
        <div class="center-marker"></div>
      </div>

      <div class="controls">
        <button id="spin" class="disabled">SPIN</button>
      </div>

      <div id="result" class="hidden"></div>
    </div>
  </main>

  <footer>Logo & background bisa diupload sendiri • Ganti link download & gambar mod di kode</footer>
</div>

<audio id="bgm" autoplay loop></audio>

<script>
/* CONFIG - ganti link gambar & download di sini jika mau nanti */
const CONFIG = {
  CHANNEL_URL: 'https://www.youtube.com/', // ganti channel kamu
  MUSIC_URL: 'https://music.youtube.com/watch?v=iisOyaFF58g&list=RDAMVMevTxdgbAF1Q', // sesuai inputmu
  MODS: [
    {id:'m1', name:'Mod Alpha (SSR)', img:'https://via.placeholder.com/200x120?text=Alpha', file:'https://example.com/mod1.zip'},
    {id:'m2', name:'Mod Beta (SR)', img:'https://via.placeholder.com/200x120?text=Beta', file:'https://example.com/mod2.zip'},
    {id:'m3', name:'Mod Gamma (R)', img:'https://via.placeholder.com/200x120?text=Gamma', file:'https://example.com/mod3.zip'},
    {id:'m4', name:'Mod Delta (R)', img:'https://via.placeholder.com/200x120?text=Delta', file:'https://example.com/mod4.zip'},
    {id:'m5', name:'Mod Epsilon (SR)', img:'https://via.placeholder.com/200x120?text=Epsilon', file:'https://example.com/mod5.zip'},
    {id:'m6', name:'Mod Zeta (SSR)', img:'https://via.placeholder.com/200x120?text=Zeta', file:'https://example.com/mod6.zip'}
  ]
};

/* UI refs */
const subscribeBtn = document.getElementById('subscribeBtn');
const enterGacha = document.getElementById('enterGacha');
const spinBtn = document.getElementById('spin');
const track = document.getElementById('track');
const viewport = document.getElementById('viewport');
const result = document.getElementById('result');
const bgm = document.getElementById('bgm');
const logoInput = document.getElementById('logoInput');
const bgInput = document.getElementById('bgInput');
const logoEl = document.getElementById('logo');

/* init */
subscribeBtn.href = CONFIG.CHANNEL_URL;
bgm.src = CONFIG.MUSIC_URL; // NOTE: many YouTube links won't play via <audio>; keep a direct mp3 for reliable autoplay

// build duplicated sequence for smooth motion (duplicate once)
function buildTrack(){
  track.innerHTML = '';
  const arr = CONFIG.MODS.concat(CONFIG.MODS); // duplicate array
  arr.forEach(mod=>{
    const c = document.createElement('div'); c.className='card';
    c.dataset.id = mod.id;
    c.dataset.file = mod.file;
    c.innerHTML = `<img src="${mod.img}" alt="${mod.name}"><div class="name">${mod.name}</div>`;
    track.appendChild(c);
  });
}
buildTrack();

/* enable Gacha when user clicked subscribe button (no real verification) */
subscribeBtn.addEventListener('click', ()=>{
  localStorage.setItem('gacha_sub_clicked', Date.now());
  setTimeout(()=>enableEnter(), 700);
});
function enableEnter(){ enterGacha.disabled=false; enterGacha.classList.remove('disabled'); spinBtn.classList.remove('disabled'); spinBtn.disabled = false; }

/* persist */
if(localStorage.getItem('gacha_sub_clicked')) enableEnter();

enterGacha.addEventListener('click', ()=> {
  // scroll to viewport (visual)
  viewport.scrollIntoView({behavior:'smooth', block:'center'});
  // attempt play bgm
  bgm.play().catch(()=>{ /* browsers may block autoplay with sound */ });
});

/* file inputs for logo and background */
logoInput.addEventListener('change', e=>{
  const f = e.target.files[0];
  if(!f) return;
  const url = URL.createObjectURL(f);
  logoEl.style.backgroundImage = `url(${url})`;
  logoEl.textContent = '';
});
bgInput.addEventListener('change', e=>{
  const f = e.target.files[0];
  if(!f) return;
  const url = URL.createObjectURL(f);
  document.body.style.backgroundImage = `url(${url})`;
  document.body.style.backgroundSize = 'cover';
});

/* Spin logic: animate translateX with velocity decay until stop at chosen index */
let isSpinning=false;
spinBtn.addEventListener('click', ()=>{ if(isSpinning) return; startSpin(); });

function startSpin(){
  isSpinning = true;
  result.classList.add('hidden');
  // pick final index among first 6 (original set)
  const finalIndex = Math.floor(Math.random()*CONFIG.MODS.length);
  const chosen = CONFIG.MODS[finalIndex];
  // compute target translate so that the chosen card (the one in first half) aligns center
  // note: track contains duplicate array so we'll target the first occurrence (index = finalIndex)
  const cards = track.children;
  const card = cards[finalIndex]; // choose the first block
  // measure
  const viewportRect = viewport.getBoundingClientRect();
  const cardRect = card.getBoundingClientRect();
  const cardWidth = cardRect.width + 12; // include gap
  // starting translateX position (we'll animate transform)
  let currentX = 0; // starting from left
  let velocity = (Math.random()*40 + 80); // pixels per frame approx high speed
  const friction = 0.985 - (Math.random()*0.003); // slow down factor
  // target center position (we want chosen card to be centered)
  // compute chosen card's offsetLeft relative to track
  const chosenOffset = card.offsetLeft;
  const viewportCenter = viewport.clientWidth / 2;
  const targetX = -(chosenOffset - (viewportCenter - (cardRect.width/2)));
  // but since track is duplicated, choose target that is >= currentX
  // We'll animate until we pass the target while slowing down; to make it stop exactly, we'll use easing at the end.
  let rafId;
  let frames = 0;
  function step(){
    frames++;
    // move
    currentX -= velocity * (1/60); // normalized by fps
    // wrap-around: keep currentX within a big range to avoid too large numbers (not necessary but safe)
    // apply transform
    track.style.transform = `translateX(${currentX}px)`;
    // slow down
    velocity *= friction;
    // after some time start checking closeness to target and gently approach
    if(velocity < 6){
      // when slow enough, ease to targetX
      const dx = targetX - currentX;
      // ease step
      currentX += dx * 0.12;
      track.style.transform = `translateX(${currentX}px)`;
      if(Math.abs(dx) < 1){
        cancelAnimationFrame(rafId);
        finishSpin(chosen);
        return;
      }
    } else {
      rafId = requestAnimationFrame(step);
    }
  }
  rafId = requestAnimationFrame(step);
}

function finishSpin(mod){
  isSpinning = false;
  // show result
  result.innerHTML = `<div style="display:flex;flex-direction:column;align-items:center">
      <div class="glow"><strong>Selamat! </strong>Anda mendapatkan <em>${mod.name}</em></div>
      <div style="margin-top:10px"><a class="small-btn" id="downloadBtn" href="${mod.file}" target="_blank">Download Mod</a></div>
    </div>`;
  result.classList.remove('hidden');
}

/* mobile-friendly: touch support for faster spin trigger */
let touchStartTime=0;
viewport.addEventListener('touchstart', ()=>{ touchStartTime=Date.now(); });
viewport.addEventListener('touchend', ()=>{ if(Date.now()-touchStartTime<500) { if(!isSpinning) startSpin(); } });

</script>
</body>
</html>
