<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>High-Tier Gacha Showcase • Limited Summon</title>
  <meta name="description" content="High-end cinematic gacha showcase with summon limits — dual mode: Showcase & Gacha."/>
  <style>
    /* ---------- THEME COLORS ---------- */
    :root{
      --bg-1:#041022; --bg-2:#07142a;
      --panel:#081829; --glass:rgba(255,255,255,0.03);
      --accent-a:#39d2ff; --accent-b:#9b7bff;
      --muted:#94a6bf; --gold:#f3d48f;
      --mythic-glow:#ffd700; --legend-glow:#9b7bff;
      --elite-glow:#39d2ff; --common-glow:#94a6bf;
    }

    /* ---------- RESET & BASE ---------- */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;width:100%;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;color:#e6f3ff;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));-webkit-font-smoothing:antialiased;overflow:auto}
    a{color:inherit}
    button{font-family:inherit;cursor:pointer}

    /* ---------- CUSTOM SCROLLBAR ---------- */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.05);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(45deg, var(--accent-a), var(--accent-b));
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(45deg, var(--accent-b), var(--accent-a));
    }
    
    html {
      scrollbar-width: thin;
      scrollbar-color: var(--accent-a) rgba(255,255,255,0.05);
    }

    /* ---------- LAYOUT ---------- */
    .app{display:flex;flex-direction:column;min-height:100vh;width:100%;overflow:auto}
    
    /* Header */
    header.top{height:72px;display:flex;align-items:center;justify-content:space-between;padding:0 28px;background:linear-gradient(180deg, rgba(255,255,255,0.05), transparent);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.02);position:relative;overflow:hidden;flex-shrink:0}
    .shine-effect{position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);animation:shine 8s infinite}
    
    @keyframes shine{
      0%{left:-100%}
      20%{left:100%}
      100%{left:100%}
    }

    .brand{display:flex;gap:14px;align-items:center;position:relative;z-index:2}
    .logo{width:50px;height:50px;border-radius:12px;background:linear-gradient(135deg,var(--accent-a),var(--accent-b));display:flex;align-items:center;justify-content:center;color:#021226;font-weight:800;box-shadow:0 10px 40px rgba(57,210,255,0.15);animation:pulse 4s ease-in-out infinite}
    .title{font-weight:800;letter-spacing:0.6px;background:linear-gradient(45deg, var(--accent-a), var(--accent-b));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .subtitle{font-size:12px;color:var(--muted);margin-top:2px}

    @keyframes pulse{
      0%, 100%{transform:scale(1);box-shadow:0 10px 40px rgba(57,210,255,0.15)}
      50%{transform:scale(1.05);box-shadow:0 15px 50px rgba(57,210,255,0.25)}
    }

    nav.controls{display:flex;gap:10px;align-items:center;position:relative;z-index:2}
    .btn{padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;cursor:pointer;font-weight:700;transition:all 0.3s ease;position:relative;overflow:hidden}
    .btn.ghost{background:transparent}
    .btn.primary{background:linear-gradient(90deg,var(--accent-a),var(--accent-b));color:#021226;border:none;box-shadow:0 8px 30px rgba(57,210,255,0.15)}
    .btn.small{padding:8px 10px;font-size:13px}
    .btn:disabled{opacity:0.6;cursor:not-allowed}
    .btn:not(:disabled):hover{transform:translateY(-2px);box-shadow:0 12px 40px rgba(57,210,255,0.2)}

    main.main{flex:1;display:flex;gap:28px;padding:26px 36px;position:relative;overflow:auto;min-height:calc(100vh - 72px)}

    /* left column */
    aside.left{width:260px;display:flex;flex-direction:column;gap:18px;flex-shrink:0}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 16px 60px rgba(2,6,20,0.55);position:relative;overflow:hidden}
    .card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255,255,255,0.03), transparent);animation:cardShine 6s infinite}
    .card h4{color:var(--accent-a);margin-bottom:10px;position:relative;z-index:1}
    .muted{color:var(--muted);font-size:13px;position:relative;z-index:1}

    @keyframes cardShine{
      0%{left:-100%}
      20%{left:100%}
      100%{left:100%}
    }

    /* center area */
    .center{flex:1;position:relative;display:flex;align-items:flex-start;justify-content:center;overflow:auto;min-width:0}

    /* background slideshow container */
    .bg-container{position:absolute;inset:0;z-index:0;overflow:hidden}
    .bg-slide{position:absolute;inset:0;background-size:cover;background-position:center;opacity:0;transform:scale(1.03);transition:opacity 1200ms ease, transform 1000ms ease}
    .bg-slide.active{opacity:1;transform:scale(1)}
    .bg-overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(2,6,20,0.25), rgba(2,6,30,0.6));z-index:1}

    /* showcase carousel container */
    .showcase-wrap{position:relative;z-index:2;width:100%;max-width:1400px;padding:48px 32px;display:flex;flex-direction:column;gap:18px;align-items:center;justify-content:flex-start;min-height:min-content}
    .showcase-title{display:flex;align-items:center;gap:12px;width:100%;justify-content:space-between;flex-shrink:0}
    .showcase-title h2{font-size:20px;letter-spacing:1px;background:linear-gradient(45deg, var(--accent-a), var(--accent-b));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .showcase-view{width:100%;overflow:auto;padding:20px 0 28px 0;position:relative;min-height:min-content}
    
    /* slider navigation */
    .slider-nav{display:flex;gap:10px;align-items:center;flex-shrink:0}

    /* CAROUSEL GRID 3x2 */
    .carousel{display:grid;grid-template-columns:repeat(3, 1fr);grid-template-rows:repeat(2, 1fr);gap:28px;width:100%;max-width:100%;transition:none;transform:none !important}
    
    /* panel - medium size dengan aura */
    .panel{width:100%;height:620px;border-radius:14px;overflow:visible;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.08));backdrop-filter:blur(6px);position:relative;box-shadow:0 40px 120px rgba(2,8,20,0.6);transform:none;transition:all 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)}
    .panel-inner{transform:none;width:100%;height:100%;position:relative;display:flex;flex-direction:column;align-items:center;border-radius:14px;overflow:hidden}
    
    /* Aura effect container */
    .aura-container{position:absolute;top:-5px;left:-5px;right:-5px;bottom:-5px;border-radius:16px;z-index:0;opacity:0;transition:opacity 0.5s ease;pointer-events:none;overflow:hidden}
    .panel.active .aura-container{opacity:0.8}
    .aura{position:absolute;top:50%;left:50%;width:140%;height:140%;background:conic-gradient(from 0deg, transparent, var(--aura-color), transparent);transform:translate(-50%, -50%) rotate(0deg);animation:rotateAura 4s linear infinite;border-radius:50%}
    .aura-2{animation-delay:-2s; opacity:0.7}
    
    @keyframes rotateAura{
      0%{transform:translate(-50%, -50%) rotate(0deg)}
      100%{transform:translate(-50%, -50%) rotate(360deg)}
    }

    .panel img{width:100%;height:82%;object-fit:cover;display:block;border-bottom:1px solid rgba(255,255,255,0.03);position:relative;z-index:1;transition:all 0.3s ease;transform:scale(1.01)}
    .panel.active img{filter:brightness(1.1) contrast(1.05)}
    
    .panel .meta{padding:16px;width:100%;display:flex;align-items:center;justify-content:space-between;position:relative;z-index:1;background:linear-gradient(180deg, transparent, rgba(8,24,41,0.95))}
    .pname{font-weight:800;color:var(--accent-a);font-size:18px;text-shadow:0 2px 10px rgba(0,0,0,0.5)}
    .prarity{font-weight:700;font-size:12px;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);color:var(--muted)}

    /* hover focus dengan efek glow */
    .panel:hover{transform:translateY(-18px) scale(1.02);box-shadow:0 60px 140px rgba(3,12,30,0.75);filter:brightness(1.04)}
    .panel:hover .aura-container{opacity:0.6}
    .panel.active{transform:translateY(-12px) scale(1);box-shadow:0 50px 130px var(--aura-glow, rgba(57,210,255,0.3))}

    /* HERO SPOT */
    .hero-spot {
      position: absolute;
      right: 4%;
      bottom: 6%;
      z-index: 3;
      width: 420px;
      height: 640px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 60px 160px rgba(3,10,20,0.6);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15));
      border: 1px solid rgba(255,255,255,0.03);
      position: relative;
    }

    .hero-image-container {
      width: 100%;
      height: 100%;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .hero-image-container img {
      width: 100%;
      height: 85%;
      object-fit: cover;
      object-position: top center;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      transition: opacity 0.5s ease-in-out;
    }

    .hero-image-container img[src=""] {
      opacity: 0;
    }

    .hero-image-container img:not([src=""]) {
      opacity: 1;
    }

    .hero-content {
      padding: 20px;
      background: linear-gradient(180deg, transparent, rgba(8,24,41,0.95));
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 2;
    }

    .hero-spot::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
      animation: cardShine 8s infinite;
      z-index: 1;
    }

    /* SUMMON PORTAL BESAR DI TENGAH - FIXED SIZE */
    .summon-portal {
      position: relative;
      z-index: 4;
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 30px;
      margin: 0 auto;
      padding: 20px;
    }

    .portal-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 25px;
      width: 100%;
      height: 500px;
      max-height: 60vh;
    }

    .portal-character {
      border-radius: 16px;
      overflow: hidden;
      background: rgba(255,255,255,0.03);
      border: 3px solid rgba(255,255,255,0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 200px;
    }

    .portal-character:hover {
      transform: scale(1.08);
      border-color: var(--accent-a);
      box-shadow: 0 15px 40px rgba(57,210,255,0.4);
    }

    .portal-character.active {
      transform: scale(1.12);
      border-color: var(--accent-a);
      box-shadow: 0 20px 50px rgba(57,210,255,0.6);
      z-index: 2;
    }

    .portal-character img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .portal-character:hover img {
      transform: scale(1.1);
    }

    .portal-character.active img {
      transform: scale(1.15);
    }

    .portal-controls {
      display: flex;
      gap: 25px;
      align-items: center;
      margin-top: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    /* gacha board */
    .gacha-board{position:relative;z-index:4;background:linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));padding:18px 24px;border-radius:14px;border:1px solid rgba(255,255,255,0.05);display:flex;gap:24px;align-items:center;backdrop-filter:blur(12px);box-shadow:0 20px 80px rgba(2,6,20,0.8);min-width:max-content;width:100%;max-width:800px;margin:0 auto}
    .gacha-board::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(57,210,255,0.1), transparent);animation:cardShine 10s infinite}
    
    .gtiles{display:flex;gap:12px;overflow-x:auto;padding-bottom:10px}
    .gtile{width:88px;height:116px;border-radius:10px;overflow:hidden;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.06);transition:all 300ms ease;position:relative;flex-shrink:0}
    .gtile::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;border-radius:10px;background:linear-gradient(45deg, transparent, rgba(255,255,255,0.08), transparent);opacity:0;transition:opacity 0.3s ease}
    .gtile:hover::before{opacity:1}
    .gtile.sel{box-shadow:0 20px 60px rgba(57,210,255,0.4);transform:translateY(-10px) scale(1.05);border-color:var(--accent-a)}
    
    .spin-btn{padding:14px 32px;border-radius:12px;background:linear-gradient(90deg,var(--accent-a),var(--accent-b));border:none;font-weight:900;cursor:pointer;box-shadow:0 18px 60px rgba(57,210,255,0.2);transition:all 0.3s ease;position:relative;overflow:hidden;font-size:14px;letter-spacing:0.5px}
    .spin-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none !important}
    .spin-btn:not(:disabled):hover{transform:translateY(-3px);box-shadow:0 25px 80px rgba(57,210,255,0.3)}
    .spin-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);transition:left 0.6s ease}
    .spin-btn:hover::before{left:100%}

    /* result popup dengan efek glow */
    .result-overlay{position:fixed;inset:0;z-index:60;display:flex;align-items:center;justify-content:center;background:rgba(0,6,12,0.9);pointer-events:none;opacity:0;transition:opacity 0.4s ease;backdrop-filter:blur(8px)}
    .result-overlay.open{pointer-events:auto;opacity:1}
    .result-card{width:520px;background:linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));padding:32px;border-radius:18px;border:1px solid rgba(255,255,255,0.08);text-align:center;box-shadow:0 40px 140px rgba(2,6,20,0.9);position:relative;overflow:hidden;transform:scale(0.9) translateY(20px);transition:all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);opacity:0}
    .result-overlay.open .result-card{transform:scale(1) translateY(0);opacity:1}
    .result-card::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(from 0deg, transparent, var(--result-glow, rgba(57,210,255,0.15)), transparent);animation:rotateAura 6s linear infinite}
    .result-card h2{color:var(--gold);margin-bottom:12px;position:relative;z-index:1;font-size:26px;text-shadow:0 2px 20px rgba(243,212,143,0.3)}
    .result-card p{color:var(--muted);position:relative;z-index:1;font-size:15px;line-height:1.5}
    .result-actions{display:flex;gap:14px;justify-content:center;margin-top:24px;position:relative;z-index:1}

    /* Character Image di Result */
    .result-character-image {
      width: 200px;
      height: 300px;
      margin: 0 auto 20px;
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      border: 2px solid rgba(255,255,255,0.1);
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .result-character-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* loading spinner */
    .spinner{width:20px;height:20px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:spin 1s linear infinite;display:inline-block}

    @keyframes spin{
      0%{transform:rotate(0deg)}
      100%{transform:rotate(360deg)}
    }

    /* Summon Limit Styles */
    .summon-limit {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.05);
      margin: 10px 0;
      position: relative;
      z-index: 1;
    }
    
    .limit-counter {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .limit-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #00C851;
      transition: all 0.3s ease;
    }
    
    .limit-dot.used {
      background: #ff4444;
    }
    
    .limit-text {
      color: var(--muted);
      font-size: 11px;
    }
    
    .cooldown-timer {
      background: linear-gradient(45deg, #ff4444, #cc0000);
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      display: none;
      align-items: center;
      gap: 4px;
    }
    
    .cooldown-timer.show {
      display: flex;
    }

    /* Subscription Verification Modal */
    .verification-modal {
      position: fixed;
      inset: 0;
      z-index: 70;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,6,12,0.95);
      backdrop-filter: blur(10px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }
    
    .verification-modal.active {
      opacity: 1;
      pointer-events: auto;
    }
    
    .verification-content {
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
      padding: 40px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.08);
      text-align: center;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 40px 140px rgba(2,6,20,0.9);
      position: relative;
      overflow: hidden;
    }
    
    .verification-content::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: conic-gradient(from 0deg, transparent, rgba(57,210,255,0.1), transparent);
      animation: rotateAura 8s linear infinite;
    }
    
    .verification-icon {
      font-size: 48px;
      margin-bottom: 20px;
      position: relative;
      z-index: 1;
    }
    
    .verification-title {
      color: var(--accent-a);
      font-size: 24px;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }
    
    .verification-text {
      color: var(--muted);
      margin-bottom: 24px;
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }
    
    .verification-steps {
      background: rgba(255,255,255,0.02);
      border-radius: 12px;
      padding: 20px;
      margin: 24px 0;
      text-align: left;
      position: relative;
      z-index: 1;
      border: 1px solid rgba(255,255,255,0.05);
    }
    
    .verification-step {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.3s ease;
    }
    
    .verification-step:hover {
      background: rgba(255,255,255,0.03);
    }
    
    .step-number {
      width: 24px;
      height: 24px;
      background: linear-gradient(45deg, var(--accent-a), var(--accent-b));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 800;
      color: #021226;
    }
    
    .step-text {
      color: var(--muted);
      font-size: 14px;
    }
    
    .verification-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      position: relative;
      z-index: 1;
    }
    
    .verification-btn {
      padding: 12px 24px;
      border-radius: 10px;
      border: none;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .verification-btn.primary {
      background: linear-gradient(45deg, var(--accent-a), var(--accent-b));
      color: #021226;
    }
    
    .verification-btn.secondary {
      background: rgba(255,255,255,0.05);
      color: var(--muted);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .verification-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(57,210,255,0.2);
    }
    
    .subscription-badge {
      background: linear-gradient(45deg, #FF0000, #CC0000);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: 8px;
      animation: pulse 2s infinite;
    }
    
    .verification-success {
      background: linear-gradient(45deg, #00C851, #007E33);
      color: white;
      padding: 12px 20px;
      border-radius: 10px;
      margin: 20px 0;
      display: none;
      align-items: center;
      gap: 10px;
      justify-content: center;
      position: relative;
      z-index: 1;
    }
    
    .verification-success.show {
      display: flex;
    }
    
    .access-granted {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: linear-gradient(45deg, #00C851, #007E33);
      color: white;
      padding: 20px 40px;
      border-radius: 15px;
      font-weight: 800;
      font-size: 18px;
      z-index: 80;
      box-shadow: 0 20px 60px rgba(0,200,81,0.3);
      transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .access-granted.show {
      transform: translate(-50%, -50%) scale(1);
    }

    /* Enhanced security indicators */
    .security-status {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      margin: 10px 0;
      position: relative;
      z-index: 1;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ff4444;
      animation: pulse 2s infinite;
    }
    
    .status-dot.verified {
      background: #00C851;
    }
    
    .status-text {
      color: var(--muted);
      font-size: 12px;
      font-weight: 600;
    }

    /* notification */
    .notification{position:fixed;top:20px;right:20px;padding:12px 20px;background:linear-gradient(90deg, var(--accent-a), var(--accent-b));color:#021226;border-radius:8px;font-weight:600;z-index:100;transform:translateX(100%);transition:transform 0.3s ease;box-shadow:0 10px 30px rgba(57,210,255,0.3)}
    .notification.show{transform:translateX(0)}

    .refresh-notification {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: linear-gradient(45deg, var(--accent-a), var(--accent-b));
      color: #021226;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 700;
      z-index: 90;
      box-shadow: 0 10px 30px rgba(57,210,255,0.3);
      transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .refresh-notification.show {
      transform: translateX(-50%) translateY(0);
    }

    /* Music Player Styles - FIXED POSITION */
    .music-player {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 50;
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      min-width: 200px;
    }

    .music-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .music-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(45deg, var(--accent-a), var(--accent-b));
      color: #021226;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .music-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 15px rgba(57,210,255,0.4);
    }

    .music-select {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 8px 12px;
      color: var(--muted);
      font-size: 12px;
      min-width: 140px;
      flex: 1;
    }

    .music-info {
      font-size: 11px;
      color: var(--muted);
      margin-top: 8px;
      text-align: center;
      width: 100%;
    }

    /* Fireworks Animation */
    .firework {
      position: absolute;
      width: 5px;
      height: 5px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 55;
    }

    /* Starfield Animation */
    .starfield {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle var(--duration) infinite ease-in-out;
      opacity: var(--opacity);
    }

    @keyframes twinkle {
      0%, 100% { opacity: var(--opacity); }
      50% { opacity: calc(var(--opacity) * 0.3); }
    }

    /* MOBILE RESPONSIVE - IMPROVED */
    @media (max-width: 1400px) {
      .portal-grid {
        height: 400px;
        gap: 20px;
      }
    }

    @media (max-width: 1200px) {
      .hero-spot {
        width: 350px;
        height: 550px;
      }
      
      .portal-grid {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, 1fr);
        height: 600px;
      }
      
      .carousel {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, 1fr);
      }
    }

    @media (max-width: 1100px){
      .hero-spot{display:none}
      .panel{height:520px}
      .gacha-board{gap:18px; padding:16px 20px}
      .summon-portal {
        width: 100%;
        height: auto;
      }
      .portal-grid {
        height: 500px;
      }
      .music-player {
        bottom: 80px;
        right: 10px;
      }
    }

    @media (max-width: 900px){
      .gacha-board{flex-direction:column; gap:16px; width:90%}
      .gtiles{order:2}
      .summon-portal {
        width: 100%;
        height: auto;
      }
      .portal-grid {
        height: 400px;
        gap: 15px;
      }
      .carousel {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, 1fr);
      }
      
      .portal-controls {
        flex-direction: column;
        gap: 15px;
      }
    }

    @media (max-width: 768px) {
      .portal-grid {
        grid-template-columns: 1fr;
        grid-template-rows: repeat(6, 1fr);
        height: 700px;
        gap: 12px;
      }
      
      .portal-character {
        min-height: 150px;
      }
      
      .summon-portal {
        padding: 15px;
        gap: 20px;
      }
      
      .music-player {
        position: relative;
        bottom: auto;
        right: auto;
        margin: 20px auto;
        width: 90%;
        max-width: 300px;
      }
    }

    @media (max-width:720px){
      aside.left{display:none}
      .panel{height:420px}
      .showcase-wrap{padding:20px 16px}
      .gacha-board{left:5%;transform:translateX(0);bottom:16px; width:90%}
      .main{padding:10px}
      .shine-effect{animation:shine 12s infinite}
      .carousel{
        grid-template-columns: 1fr;
        grid-template-rows: repeat(6, 1fr);
        gap: 20px;
      }
      .summon-portal {
        width: 100%;
        height: auto;
      }
      .portal-grid {
        height: 600px;
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .portal-grid {
        height: 500px;
      }
      
      .portal-character {
        min-height: 120px;
      }
      
      .result-card {
        width: 95%;
        padding: 20px;
        margin: 10px;
      }
      
      .result-character-image {
        width: 150px;
        height: 225px;
      }
      
      .music-player {
        width: 95%;
      }
    }

    /* utility */
    .hide{display:none !important}
    .flex{display:flex}
    .center{align-items:center;justify-content:center}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
  </style>
</head>
<body>
  <div class="app">
    <header class="top" role="banner" aria-label="Header utama">
      <div class="shine-effect"></div>
      <div class="brand">
        <div class="logo" aria-label="Logo Gacha">G</div>
        <div>
          <div class="title">Gacha • Event Showcase 
            <span class="subscription-badge" id="subBadge" style="display: none;">
              <span>✓</span> SUBSCRIBED
            </span>
          </div>
          <div class="subtitle">Limited Summon • 5 Summons Daily</div>
        </div>
      </div>

      <nav class="controls" aria-label="Navigasi kontrol">
        <button id="modeBtn" class="btn ghost small">Mode: Showcase</button>
        <button id="openChannel" class="btn small">Verify Subscription</button>
        <button id="enableBtn" class="btn primary" style="display: none;">Access Gacha</button>
      </nav>
    </header>

    <main class="main" role="main" aria-label="Konten utama">
      <!-- LEFT: info -->
      <aside class="left" aria-label="Informasi panel">
        <div class="card">
          <h4>Subscription Required</h4>
          <div class="security-status">
            <div class="status-dot" id="statusDot"></div>
            <div class="status-text" id="statusText">Verification Required</div>
          </div>
          <p class="muted">Subscribe to our YouTube channel to unlock summon features.</p>
        </div>

        <div class="card">
          <h4>Summon Limits</h4>
          <div class="summon-limit">
            <div class="limit-counter" id="limitCounter">
              <!-- Dots akan diisi oleh JavaScript -->
            </div>
            <div class="limit-text">5 summons per day</div>
          </div>
          <div class="cooldown-timer" id="cooldownTimer">
            <span>⏰</span>
            <span id="cooldownText">Resets in: 24:00:00</span>
          </div>
          <p class="muted">Daily limit: 5 summons • Resets every 24 hours</p>
        </div>

        <div class="card">
          <h4>Rarity Rates</h4>
          <p class="muted" id="ratesSummary">Mythic: 2% • Legendary: 8% • Elite: 20% • Common: 70%</p>
        </div>
      </aside>

      <!-- CENTER: showcase & gacha -->
      <section class="center" aria-label="Area showcase dan gacha">
        <div class="bg-container" id="bgContainer"></div>
        <div class="bg-overlay"></div>
        <div class="starfield" id="starfield"></div>

        <!-- SHOWCASE MODE -->
        <div class="showcase-wrap" id="showcaseWrap">
          <div class="showcase-title">
            <div>
              <h2>Character Showcase</h2>
              <div class="muted">Grid layout 3x2 • 6 characters • Click to preview</div>
            </div>
            <div class="slider-nav">
              <span class="muted" id="slideCounter">Grid View</span>
            </div>
          </div>

          <div class="showcase-view" id="showcaseView">
            <div id="carousel" class="carousel">
              <!-- 6 panels dengan layout grid 3x2 -->
              <div class="panel" data-name="Sasuke Uchiha" data-rarity="Mythic" data-file="SasukeRinnegan" data-description="Uchiha" data-aura-color="#ffd700">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #ffd700"></div>
                  <div class="aura aura-2" style="--aura-color: #ffd700"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel1.png" alt="Sasuke Uchiha - Mythic rarity" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">Sasuke</div>
                    <div class="prarity">Mythic</div>
                  </div>
                </div>
              </div>

              <div class="panel" data-name="Obito Uchiha" data-rarity="Legendary" data-file="ObitoUnmasked" data-description="Uchiha" data-aura-color="#9b7bff">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #9b7bff"></div>
                  <div class="aura aura-2" style="--aura-color: #9b7bff"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel2.png" alt="Obito Uchiha - Legendary rarity" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">Obito</div>
                    <div class="prarity">Legend</div>
                  </div>
                </div>
              </div>

              <div class="panel" data-name="Madara Uchiha" data-rarity="Supreme" data-file="Madara" data-description="Uchiha" data-aura-color="#39d2ff">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #39d2ff"></div>
                  <div class="aura aura-2" style="--aura-color: #39d2ff"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel3.png" alt="Madara Uchiha - Supreme" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">Madara</div>
                    <div class="prarity">Elite</div>
                  </div>
                </div>
              </div>

              <div class="panel" data-name="Naruto" data-rarity="Common" data-file="Naruto" data-description="Uzumaki" data-aura-color="#94a6bf">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #94a6bf"></div>
                  <div class="aura aura-2" style="--aura-color: #94a6bf"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel4.png" alt="Naruto - Elite rarity" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">Naruto</div>
                    <div class="prarity">Common</div>
                  </div>
                </div>
              </div>

              <div class="panel" data-name="SasukeHebi" data-rarity="Elite" data-file="SasukeHebi" data-description="Uchiha" data-aura-color="#39d2ff">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #39d2ff"></div>
                  <div class="aura aura-2" style="--aura-color: #39d2ff"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel5.png" alt="SasukeHebi - Elite rarity" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">SasukeHebi</div>
                    <div class="prarity">Elite</div>
                  </div>
                </div>
              </div>

              <div class="panel" data-name="BorutoUzumaki" data-rarity="Legendary" data-file="BorutoUzumaki" data-description="Uzumaki" data-aura-color="#9b7bff">
                <div class="aura-container">
                  <div class="aura" style="--aura-color: #9b7bff"></div>
                  <div class="aura aura-2" style="--aura-color: #9b7bff"></div>
                </div>
                <div class="panel-inner">
                  <img src="./assets/panels/panel6.png" alt="BorutoUzumaki - Legendary rarity" onerror="handleImageError(this)">
                  <div class="meta">
                    <div class="pname">BorutoUzumaki</div>
                    <div class="prarity">Legend</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- HERO SPOT -->
        <div class="hero-spot" id="heroSpot">
          <div class="hero-image-container">
            <img id="heroImage" src="" alt="Character Preview" onerror="handleImageError(this)">
            <div class="hero-content">
              <h3 id="heroName">Select a Character</h3>
              <p id="heroDesc" class="muted">Click on any character to preview</p>
            </div>
          </div>
        </div>

        <!-- SUMMON PORTAL BESAR DI TENGAH - FIXED SIZE -->
        <div class="summon-portal hide" id="summonPortal">
          <div class="portal-grid" id="portalGrid">
            <!-- Portal characters akan diisi oleh JavaScript -->
          </div>
          <div class="portal-controls">
            <div style="display:flex;flex-direction:column;gap:8px;align-items:center;">
              <div style="font-weight:800; font-size:18px">Summon Portal</div>
              <div class="muted" style="font-size:14px">
                <span id="summonsLeft">5</span> summons remaining today
              </div>
            </div>
            <button id="summonBtn" class="spin-btn" disabled>SUMMON</button>
            <button id="singleSummon" class="btn small" disabled>Single</button>
          </div>
        </div>

        <!-- GACHA MODE -->
        <div class="gacha-board hide" id="gachaBoard" aria-label="Portal summon gacha">
          <div style="display:flex;flex-direction:column;gap:12px;align-items:center;position:relative;z-index:1">
            <button id="summonBtnBottom" class="spin-btn" disabled>SUMMON</button>
            <button id="singleSummonBottom" class="btn small" disabled>Single</button>
          </div>
          <div class="gtiles">
            <!-- Gacha tiles akan diisi oleh JavaScript -->
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Music Player - FIXED POSITION -->
  <div class="music-player" id="musicPlayer">
    <div class="music-controls">
      <button class="music-btn" id="prevMusic">⏮</button>
      <button class="music-btn" id="playPause">▶️</button>
      <button class="music-btn" id="nextMusic">⏭</button>
      <select class="music-select" id="musicSelect">
        <option value="0">Background Music 1</option>
        <option value="1">Background Music 2</option>
        <option value="2">Background Music 3</option>
        <option value="3">Background Music 4</option>
        <option value="4">Background Music 5</option>
      </select>
    </div>
    <div class="music-info" id="musicInfo">Now Playing: Background Music 1</div>
  </div>

  <!-- Refresh Notification -->
  <div class="refresh-notification" id="refreshNotification">
    <span>🔄</span>
    Summon limits reset daily at midnight!
  </div>

  <!-- Verification Modal -->
  <div class="verification-modal" id="verificationModal">
    <div class="verification-content">
      <div class="verification-icon">🔒</div>
      <h2 class="verification-title">Subscription Required</h2>
      <p class="verification-text">To access summon features, you need to be subscribed to our YouTube channel.</p>
      
      <div class="verification-steps">
        <div class="verification-step">
          <div class="step-number">1</div>
          <div class="step-text">Click the button below to open our YouTube channel</div>
        </div>
        <div class="verification-step">
          <div class="step-number">2</div>
          <div class="step-text">Subscribe to the channel if you haven't already</div>
        </div>
        <div class="verification-step">
          <div class="step-number">3</div>
          <div class="step-text">Return to this page and click "I've Subscribed"</div>
        </div>
        <div class="verification-step">
          <div class="step-number">4</div>
          <div class="step-text">Complete verification to unlock summon features</div>
        </div>
      </div>

      <div class="verification-success" id="verificationSuccess">
        <span>✓</span> Subscription verified successfully!
      </div>

      <div class="verification-actions">
        <button class="verification-btn secondary" id="closeVerification">Cancel</button>
        <button class="verification-btn primary" id="openYoutube">Open YouTube Channel</button>
        <button class="verification-btn primary" id="confirmSubscription" style="display: none;">I've Subscribed ✓</button>
      </div>
    </div>
  </div>

  <!-- Access Granted Animation -->
  <div class="access-granted" id="accessGranted">
    <span>🎮</span> GACHA ACCESS GRANTED!
  </div>

  <!-- Result Overlay -->
  <div class="result-overlay" id="resultOverlay" aria-hidden="true">
    <div class="result-card">
      <div class="result-character-image" id="resultCharacterImage">
        <img src="" alt="Summoned Character" id="resultCharImg">
      </div>
      <h2 id="resultTitle">Mythic • You Obtained Sasuke</h2>
      <p id="resultText">Beautiful reveal animation — Download secured with single-use token.</p>
      <div class="result-actions">
        <button id="claimBtn" class="btn primary">Download File</button>
        <button id="closeResult" class="btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification"></div>

  <script>
// ==================== MUSIC FILES ====================
const MUSIC_FILES = [
  './music/music1.mp3',
  './music/music2.mp3', 
  './music/music3.mp3',
  './music/music4.mp3',
  './music/music5.mp3'
];

// ==================== BACKGROUND IMAGES ====================
const BACKGROUNDS = [
  'https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2072&q=80',
  'https://images.unsplash.com/photo-1485470733090-0aae1788d5af?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80',
  'https://images.unsplash.com/photo-1505506874110-6a7a69069a08?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2067&q=80'
];

// ==================== CHARACTER DATA ====================
const CHARACTERS = [
  {
    id: 'Sasuke',
    name: 'Sasuke Uchiha',
    rarity: 'Mythic',
    image: './assets/panels/panel1.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Abyss Walker',
    file: 'Sasuke',
    auraColor: '#ffd700',
    voice: './assets/voices/sasuke_voice.mp3'
  },
  {
    id: 'Obito',
    name: 'Obito Uchiha',
    rarity: 'Legendary',
    image: './assets/panels/panel2.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Dragon Knight',
    file: 'Obito',
    auraColor: '#9b7bff',
    voice: './assets/voices/obito_voice.mp3'
  },
  {
    id: 'Madara',
    name: 'Madara Uchiha',
    rarity: 'Elite',
    image: './assets/panels/panel3.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Oracle Seer',
    file: 'Madara',
    auraColor: '#39d2ff',
    voice: './assets/voices/madara_voice.mp3'
  },
  {
    id: 'Naruto',
    name: 'Naruto',
    rarity: 'Common',
    image: './assets/panels/panel4.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Forest Guardian',
    file: 'Naruto',
    auraColor: '#94a6bf',
    voice: './assets/voices/naruto_voice.mp3'
  },
  {
    id: 'SasukeHebi',
    name: 'SasukeHebi',
    rarity: 'Elite',
    image: './assets/panels/panel5.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Cyber Ninja',
    file: 'SasukeHebi',
    auraColor: '#39d2ff',
    voice: './assets/voices/sasukehebi_voice.mp3'
  },
  {
    id: 'BorutoUzumaki',
    name: 'BorutoUzumaki',
    rarity: 'Legendary',
    image: './assets/panels/panel6.png',
    fallback: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
    description: 'Phoenix Mage',
    file: 'BorutoUzumaki',
    auraColor: '#9b7bff',
    voice: './assets/voices/boruto_voice.mp3'
  }
];

// ==================== UTILITY FUNCTIONS ====================
function clamp(v, a=0, b=1){ return Math.max(a, Math.min(b, v)); }
function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

function handleImageError(img) {
  console.log('Image failed to load:', img.src);
  const character = CHARACTERS.find(char => char.image === img.src) || 
                   CHARACTERS.find(char => char.fallback === img.src);
  if (character) {
    img.src = character.fallback;
  } else {
    img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjUwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMDgxODI5Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmaWxsPSIjMzlkMmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+Q2hhcmFjdGVyIEltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4=';
  }
  img.alt = 'Character image not available';
  
  if (img.id === 'heroImage') {
    img.style.filter = 'grayscale(0.5) brightness(0.7)';
  }
}

function showNotification(message, duration = 3000) {
  const notification = document.getElementById('notification');
  if (!notification) return;
  
  notification.textContent = message;
  notification.classList.add('show');
  
  setTimeout(() => {
    notification.classList.remove('show');
  }, duration);
}

// ==================== BACKGROUND SYSTEM ====================
function setupBackgroundSystem() {
  const bgContainer = document.getElementById('bgContainer');
  if (!bgContainer) return;

  // Create background slides
  BACKGROUNDS.forEach((bg, index) => {
    const slide = document.createElement('div');
    slide.className = `bg-slide ${index === 0 ? 'active' : ''}`;
    slide.style.backgroundImage = `url('${bg}')`;
    bgContainer.appendChild(slide);
  });

  // Auto rotate backgrounds
  let currentBg = 0;
  setInterval(() => {
    const slides = document.querySelectorAll('.bg-slide');
    slides.forEach(slide => slide.classList.remove('active'));
    
    currentBg = (currentBg + 1) % BACKGROUNDS.length;
    if (slides[currentBg]) {
      slides[currentBg].classList.add('active');
    }
  }, 5000);
}

// ==================== HERO SPOT SYSTEM ====================
function setupHeroSpotSystem() {
  const heroImage = document.getElementById('heroImage');
  const heroName = document.getElementById('heroName');
  const heroDesc = document.getElementById('heroDesc');
  const panels = document.querySelectorAll('.panel');

  if (!heroImage || !panels.length) return;

  panels.forEach(panel => {
    panel.addEventListener('click', function() {
      const name = this.dataset.name;
      const rarity = this.dataset.rarity;
      const description = this.dataset.description;
      const img = this.querySelector('img');
      
      if (heroImage) {
        heroImage.src = img.src;
        heroImage.alt = `${name} - ${rarity}`;
      }
      if (heroName) heroName.textContent = name;
      if (heroDesc) heroDesc.textContent = `${rarity} • ${description}`;
      
      // Play character voice
      const character = CHARACTERS.find(char => char.name === name);
      if (character && window.voiceSystem) {
        window.voiceSystem.playVoice(character.voice);
      }
      
      // Add active class
      panels.forEach(p => p.classList.remove('active'));
      this.classList.add('active');
      
      showNotification(`👁️ Previewing: ${name}`, 2000);
    });

    // Hover preview with voice
    panel.addEventListener('mouseenter', function() {
      const name = this.dataset.name;
      const character = CHARACTERS.find(char => char.name === name);
      if (character && window.voiceSystem) {
        window.voiceSystem.playVoice(character.voice);
      }
    });
  });
}

// ==================== SIMPLE MODE MANAGER ====================
function setupModeManager() {
  const modeBtn = document.getElementById('modeBtn');
  const openChannelBtn = document.getElementById('openChannel');
  const enableBtn = document.getElementById('enableBtn');
  
  let currentMode = 'showcase';
  
  // Mode button
  if (modeBtn) {
    modeBtn.addEventListener('click', function() {
      console.log('🎮 Mode button clicked');
      currentMode = currentMode === 'showcase' ? 'gacha' : 'showcase';
      modeBtn.textContent = `Mode: ${currentMode.charAt(0).toUpperCase() + currentMode.slice(1)}`;
      setMode(currentMode);
    });
  }
  
  // Verify Subscription button - FIXED
  if (openChannelBtn) {
    openChannelBtn.addEventListener('click', function() {
      console.log('🔒 Verify Subscription clicked');
      const modal = document.getElementById('verificationModal');
      if (modal) {
        modal.classList.add('active');
        console.log('✅ Modal shown');
      }
    });
  }
  
  // Access Gacha button
  if (enableBtn) {
    enableBtn.addEventListener('click', function() {
      console.log('🎯 Access Gacha clicked');
      const modal = document.getElementById('verificationModal');
      if (modal) {
        modal.classList.add('active');
      }
    });
  }
  
  function setMode(mode) {
    const showcaseWrap = document.getElementById('showcaseWrap');
    const gachaBoard = document.getElementById('gachaBoard');
    const heroSpot = document.getElementById('heroSpot');
    const summonPortal = document.getElementById('summonPortal');
    
    if (mode === 'showcase') {
      if (showcaseWrap) showcaseWrap.style.display = 'flex';
      if (gachaBoard) gachaBoard.classList.add('hide');
      if (heroSpot) heroSpot.style.display = 'flex';
      if (summonPortal) summonPortal.classList.add('hide');
    } else {
      if (showcaseWrap) showcaseWrap.style.display = 'none';
      if (gachaBoard) gachaBoard.classList.remove('hide');
      if (heroSpot) heroSpot.style.display = 'none';
      if (summonPortal) summonPortal.classList.remove('hide');
    }
  }
}

// ==================== SIMPLE VERIFICATION SYSTEM ====================
function setupVerificationSystem() {
  const openYoutubeBtn = document.getElementById('openYoutube');
  const confirmSubscriptionBtn = document.getElementById('confirmSubscription');
  const closeVerificationBtn = document.getElementById('closeVerification');
  
  // Open YouTube
  if (openYoutubeBtn) {
    openYoutubeBtn.addEventListener('click', function() {
      const YT_CHANNEL = 'https://youtube.com/@your-channel';
      window.open(YT_CHANNEL, '_blank');
      
      setTimeout(() => {
        if (openYoutubeBtn) openYoutubeBtn.style.display = 'none';
        if (confirmSubscriptionBtn) confirmSubscriptionBtn.style.display = 'block';
      }, 1000);
    });
  }
  
  // Confirm Subscription
  if (confirmSubscriptionBtn) {
    confirmSubscriptionBtn.addEventListener('click', function() {
      localStorage.setItem('gacha_sub_verified', 'true');
      localStorage.setItem('gacha_session_start', Date.now().toString());
      
      // Update UI
      const subBadge = document.getElementById('subBadge');
      const statusDot = document.getElementById('statusDot');
      const statusText = document.getElementById('statusText');
      const enableBtn = document.getElementById('enableBtn');
      
      if (subBadge) subBadge.style.display = 'inline-flex';
      if (statusDot) statusDot.className = 'status-dot verified';
      if (statusText) statusText.textContent = 'Verified ✓';
      if (enableBtn) enableBtn.style.display = 'none';
      
      // Enable summon buttons
      const summonBtn = document.getElementById('summonBtn');
      const singleSummon = document.getElementById('singleSummon');
      const summonBtnBottom = document.getElementById('summonBtnBottom');
      const singleSummonBottom = document.getElementById('singleSummonBottom');
      
      if (summonBtn) summonBtn.disabled = false;
      if (singleSummon) singleSummon.disabled = false;
      if (summonBtnBottom) summonBtnBottom.disabled = false;
      if (singleSummonBottom) singleSummonBottom.disabled = false;
      
      // Hide modal
      const modal = document.getElementById('verificationModal');
      if (modal) modal.classList.remove('active');
      
      showNotification('✅ Subscription verified! Gacha access granted.');
      
      // Show access granted animation
      const accessGranted = document.getElementById('accessGranted');
      if (accessGranted) {
        accessGranted.classList.add('show');
        setTimeout(() => {
          accessGranted.classList.remove('show');
        }, 3000);
      }
    });
  }
  
  // Close modal
  if (closeVerificationBtn) {
    closeVerificationBtn.addEventListener('click', function() {
      const modal = document.getElementById('verificationModal');
      if (modal) modal.classList.remove('active');
    });
  }
  
  // Check existing verification
  function checkVerification() {
    const verified = localStorage.getItem('gacha_sub_verified');
    const sessionStart = localStorage.getItem('gacha_session_start');
    
    if (verified && sessionStart) {
      const sessionAge = Date.now() - parseInt(sessionStart);
      const SESSION_DURATION = 2 * 60 * 60 * 1000;
      
      if (sessionAge < SESSION_DURATION) {
        // User is verified
        const subBadge = document.getElementById('subBadge');
        const statusDot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');
        const enableBtn = document.getElementById('enableBtn');
        
        if (subBadge) subBadge.style.display = 'inline-flex';
        if (statusDot) statusDot.className = 'status-dot verified';
        if (statusText) statusText.textContent = 'Verified ✓';
        if (enableBtn) enableBtn.style.display = 'none';
        
        // Enable summon buttons
        const summonBtn = document.getElementById('summonBtn');
        const singleSummon = document.getElementById('singleSummon');
        const summonBtnBottom = document.getElementById('summonBtnBottom');
        const singleSummonBottom = document.getElementById('singleSummonBottom');
        
        if (summonBtn) summonBtn.disabled = false;
        if (singleSummon) singleSummon.disabled = false;
        if (summonBtnBottom) summonBtnBottom.disabled = false;
        if (singleSummonBottom) singleSummonBottom.disabled = false;
      }
    }
  }
  
  checkVerification();
}

// ==================== SIMPLE PORTAL SYSTEM ====================
function setupPortalSystem() {
  const portalGrid = document.getElementById('portalGrid');
  
  if (!portalGrid) {
    console.error('❌ Portal grid not found');
    return;
  }
  
  console.log('🎯 Creating portal characters...');
  
  // Clear existing content
  portalGrid.innerHTML = '';
  
  // Create portal characters
  CHARACTERS.forEach((character, index) => {
    const characterElement = document.createElement('div');
    characterElement.className = 'portal-character';
    characterElement.dataset.characterId = character.id;
    characterElement.dataset.index = index;
    
    characterElement.innerHTML = `
      <img src="${character.image}" alt="${character.name}" onerror="handleImageError(this)">
    `;
    
    // Click event untuk preview
    characterElement.addEventListener('click', function() {
      // Remove active class dari semua characters
      document.querySelectorAll('.portal-character').forEach(char => {
        char.classList.remove('active');
      });
      
      // Add active class ke character yang diklik
      characterElement.classList.add('active');
      
      // Play character voice
      if (window.voiceSystem) {
        window.voiceSystem.playVoice(character.voice);
      }
      
      // Show preview notification
      showNotification(`👁️ Preview: ${character.name} - ${character.rarity}`, 2000);
    });

    // HOVER VOICE PREVIEW
    characterElement.addEventListener('mouseenter', function() {
      if (window.voiceSystem) {
        window.voiceSystem.playVoice(character.voice);
      }
    });
    
    portalGrid.appendChild(characterElement);
  });
  
  console.log('✅ Portal characters created successfully');
}

// ==================== SIMPLE GACHA SYSTEM ====================
function setupGachaSystem() {
  const summonBtn = document.getElementById('summonBtn');
  const singleSummon = document.getElementById('singleSummon');
  const summonBtnBottom = document.getElementById('summonBtnBottom');
  const singleSummonBottom = document.getElementById('singleSummonBottom');
  const claimBtn = document.getElementById('claimBtn');
  const closeResult = document.getElementById('closeResult');
  
  // Summon function
  async function performSummon(full = true) {
    if (!canSummon()) {
      showNotification('🔒 Please verify subscription first');
      return;
    }
    
    // Disable buttons
    if (summonBtn) {
      summonBtn.innerHTML = '<div class="spinner"></div> Loading...';
      summonBtn.disabled = true;
    }
    if (singleSummon) singleSummon.disabled = true;
    if (summonBtnBottom) summonBtnBottom.disabled = true;
    if (singleSummonBottom) singleSummonBottom.disabled = true;
    
    try {
      // Choose random character
      const chosenRarity = chooseRarity();
      const winnerCharacter = pickCharacterByRarity(chosenRarity);
      
      console.log(`🎯 Summon result: ${winnerCharacter.name} (${winnerCharacter.rarity})`);
      
      // Simulate summon animation
      await sleep(1500);
      
      // Reveal result
      await revealCharacter(winnerCharacter);
      
    } catch (error) {
      console.error('Summon error:', error);
      showNotification('❌ Summon failed. Please try again.');
    } finally {
      // Reset buttons
      if (summonBtn) {
        summonBtn.innerHTML = 'SUMMON';
        summonBtn.disabled = false;
      }
      if (singleSummon) singleSummon.disabled = false;
      if (summonBtnBottom) summonBtnBottom.disabled = false;
      if (singleSummonBottom) singleSummonBottom.disabled = false;
    }
  }
  
  // Check if user can summon
  function canSummon() {
    const verified = localStorage.getItem('gacha_sub_verified');
    return verified === 'true';
  }
  
  // Choose rarity
  function chooseRarity() {
    const rarityRates = {
      Mythic: 0.02,
      Legendary: 0.08,
      Elite: 0.2,
      Common: 0.7
    };

    const r = Math.random();
    let sum = 0;
    for (const [rarity, rate] of Object.entries(rarityRates)) {
      sum += rate;
      if (r <= sum) return rarity;
    }
    return 'Common';
  }
  
  // Pick character by rarity
  function pickCharacterByRarity(rarity) {
    const matches = CHARACTERS.filter(char => 
      char.rarity.toLowerCase() === rarity.toLowerCase()
    );
    
    if (matches.length > 0) {
      return matches[Math.floor(Math.random() * matches.length)];
    }
    
    // Fallback ke random character
    return CHARACTERS[Math.floor(Math.random() * CHARACTERS.length)];
  }
  
  // Reveal character
  async function revealCharacter(character) {
    // Update result card
    const resultTitle = document.getElementById('resultTitle');
    const resultText = document.getElementById('resultText');
    const resultCharImg = document.getElementById('resultCharImg');
    const claimBtn = document.getElementById('claimBtn');
    
    if (resultTitle) resultTitle.textContent = `${character.rarity} • You Obtained ${character.name}`;
    if (resultText) resultText.textContent = `${character.description} - Secure download ready!`;
    if (resultCharImg) {
      resultCharImg.src = character.image;
      resultCharImg.alt = `${character.name} - ${character.rarity}`;
    }
    if (claimBtn) claimBtn.dataset.filename = character.file;
    
    // Play character voice
    if (window.voiceSystem) {
      window.voiceSystem.playVoice(character.voice);
    }
    
    // Show result overlay
    const resultOverlay = document.getElementById('resultOverlay');
    if (resultOverlay) {
      resultOverlay.classList.add('open');
    }
  }
  
  // Close result
  function closeResultHandler() {
    const resultOverlay = document.getElementById('resultOverlay');
    if (resultOverlay) {
      resultOverlay.classList.remove('open');
    }
    
    // Deactivate all portal characters
    document.querySelectorAll('.portal-character').forEach(char => {
      char.classList.remove('active');
    });
    
    // Stop voice
    if (window.voiceSystem) {
      window.voiceSystem.stopVoice();
    }
  }
  
  // Secure download
  async function secureDownload(filename) {
    try {
      showNotification('🔄 Generating secure download link...');
      await sleep(800);
      
      const downloadUrl = `./mods/${filename}.zip`;
      const link = document.createElement('a');
      link.href = downloadUrl;
      link.download = `${filename}.zip`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showNotification('✅ Download started!');
      return true;
    } catch (error) {
      console.error('Download error:', error);
      showNotification('❌ Download failed. Please try again.');
      return false;
    }
  }
  
  // Event listeners
  if (summonBtn) {
    summonBtn.addEventListener('click', () => performSummon(true));
  }
  
  if (singleSummon) {
    singleSummon.addEventListener('click', () => performSummon(false));
  }
  
  if (summonBtnBottom) {
    summonBtnBottom.addEventListener('click', () => performSummon(true));
  }
  
  if (singleSummonBottom) {
    singleSummonBottom.addEventListener('click', () => performSummon(false));
  }
  
  if (claimBtn) {
    claimBtn.addEventListener('click', async function() {
      const filename = this.dataset.filename;
      if (!filename) {
        showNotification('❌ No file available for download.');
        return;
      }
      await secureDownload(filename);
      closeResultHandler();
    });
  }
  
  if (closeResult) {
    closeResult.addEventListener('click', closeResultHandler);
  }
}

// ==================== VOICE SYSTEM ====================
class VoiceSystem {
  constructor() {
    this.currentVoice = null;
  }

  playVoice(voicePath) {
    // Stop current voice jika sedang bermain
    if (this.currentVoice) {
      this.currentVoice.pause();
      this.currentVoice.currentTime = 0;
    }

    // Check jika voice path valid
    if (!voicePath || voicePath.includes('undefined')) {
      console.warn('Invalid voice path:', voicePath);
      return;
    }

    // Play voice baru
    this.currentVoice = new Audio(voicePath);
    this.currentVoice.volume = 0.7;
    
    this.currentVoice.play().catch(error => {
      console.log('Voice play failed (normal for missing files):', error);
    });
  }

  stopVoice() {
    if (this.currentVoice) {
      this.currentVoice.pause();
      this.currentVoice.currentTime = 0;
    }
  }
}

// ==================== MUSIC PLAYER SYSTEM ====================
class MusicPlayerSystem {
  constructor() {
    this.audio = new Audio();
    this.currentTrack = 0;
    this.isPlaying = false;
    this.tracks = MUSIC_FILES;
    this.trackNames = [
      'Background Music 1',
      'Background Music 2', 
      'Background Music 3',
      'Background Music 4',
      'Background Music 5'
    ];
    
    this.init();
  }

  init() {
    this.setupEventListeners();
    this.loadTrack(0);
  }

  setupEventListeners() {
    const playPauseBtn = document.getElementById('playPause');
    const prevMusicBtn = document.getElementById('prevMusic');
    const nextMusicBtn = document.getElementById('nextMusic');
    const musicSelect = document.getElementById('musicSelect');

    if (playPauseBtn) {
      playPauseBtn.addEventListener('click', () => this.togglePlayPause());
    }
    if (prevMusicBtn) {
      prevMusicBtn.addEventListener('click', () => this.previousTrack());
    }
    if (nextMusicBtn) {
      nextMusicBtn.addEventListener('click', () => this.nextTrack());
    }
    if (musicSelect) {
      musicSelect.addEventListener('change', (e) => this.selectTrack(parseInt(e.target.value)));
    }

    this.audio.addEventListener('ended', () => this.nextTrack());
    this.audio.addEventListener('loadeddata', () => this.updateUI());
    this.audio.addEventListener('error', (e) => {
      console.error('Music loading error:', e);
      showNotification('❌ Music file not found');
    });
  }

  loadTrack(index) {
    this.currentTrack = index;
    this.audio.src = this.tracks[index];
    this.audio.volume = 0.7;
    this.audio.load().catch(error => {
      console.error('Failed to load music:', error);
    });
    this.updateUI();
  }

  async togglePlayPause() {
    if (this.isPlaying) {
      this.pause();
    } else {
      await this.play();
    }
  }

  async play() {
    try {
      await this.audio.play();
      this.isPlaying = true;
      const playPauseBtn = document.getElementById('playPause');
      if (playPauseBtn) playPauseBtn.textContent = '⏸️';
    } catch (error) {
      console.log('Audio play failed:', error);
      showNotification('❌ Cannot play music - autoplay may be blocked');
    }
  }

  pause() {
    this.audio.pause();
    this.isPlaying = false;
    const playPauseBtn = document.getElementById('playPause');
    if (playPauseBtn) playPauseBtn.textContent = '▶️';
  }

  nextTrack() {
    this.currentTrack = (this.currentTrack + 1) % this.tracks.length;
    this.loadTrack(this.currentTrack);
    if (this.isPlaying) this.play();
  }

  previousTrack() {
    this.currentTrack = (this.currentTrack - 1 + this.tracks.length) % this.tracks.length;
    this.loadTrack(this.currentTrack);
    if (this.isPlaying) this.play();
  }

  selectTrack(index) {
    this.loadTrack(index);
    if (this.isPlaying) this.play();
  }

  updateUI() {
    const musicSelect = document.getElementById('musicSelect');
    const musicInfo = document.getElementById('musicInfo');
    
    if (musicSelect) musicSelect.value = this.currentTrack;
    if (musicInfo) musicInfo.textContent = `Now Playing: ${this.trackNames[this.currentTrack]}`;
  }
}

// ==================== STARFIELD SYSTEM ====================
function setupStarfield() {
  const starfield = document.getElementById('starfield');
  if (!starfield) return;

  for (let i = 0; i < 150; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = `${Math.random() * 100}%`;
    star.style.top = `${Math.random() * 100}%`;
    star.style.width = `${Math.random() * 2 + 1}px`;
    star.style.height = star.style.width;
    star.style.setProperty('--duration', `${Math.random() * 3 + 2}s`);
    star.style.setProperty('--opacity', `${Math.random() * 0.7 + 0.3}`);
    starfield.appendChild(star);
  }
}

// ==================== INITIALIZATION ====================
document.addEventListener('DOMContentLoaded', function() {
  console.log('🚀 Initializing Gacha System...');
  
  // Setup semua systems
  setupBackgroundSystem();
  setupStarfield();
  setupHeroSpotSystem();
  setupModeManager();
  setupVerificationSystem();
  setupPortalSystem();
  setupGachaSystem();
  
  // Initialize complex systems
  window.voiceSystem = new VoiceSystem();
  window.musicPlayer = new MusicPlayerSystem();
  
  // Add error handlers ke images
  document.querySelectorAll('img').forEach(img => {
    img.addEventListener('error', () => handleImageError(img));
  });

  console.log('🎮 Gacha System Initialized Successfully!');
  console.log('✅ Background system: Working');
  console.log('✅ Hero spot system: Working');
  console.log('✅ Mode switching: Working');
  console.log('✅ Subscription verification: Working');
  console.log('✅ Portal characters: Created');
  console.log('✅ Voice system: Ready');
  console.log('✅ Music player: Ready');
  console.log('✅ All buttons: Responsive');
});
  </script>
</body>
</html>
